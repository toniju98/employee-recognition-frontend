import{j as e,o as w,p as E,T as x,b as l,q as S,I as g,Q as P,R as D,U as T,g as k,D as W,s as A,t as _,w as j,F as I,x as M,y as L,d as h,G as B,h as C,J as F,V,W as y,X as m}from"./mui-253f51e6.js";import{r as o}from"./vendor-e1e3bd03.js";import{R as N}from"./RewardCard-9cd26ee5.js";import{a as O,u as q}from"./index-7063af5f.js";import{u as z}from"./useRewardSuggestions-15ebb86f.js";import{u as G}from"./utils-ef1a3bf2.js";import"./router-2d7623d0.js";import"./auth-01303d9d.js";async function H(){const{data:i}=await O.get("/rewards/organization");return i}function J(){const[i,a]=o.useState([]),[d,t]=o.useState(!0),[r,n]=o.useState(null);return o.useEffect(()=>{(async()=>{try{const s=await H();a(s)}catch(s){n(s instanceof Error?s:new Error("Failed to fetch rewards"))}finally{t(!1)}})()},[]),{rewards:i,loading:d,error:r}}const K=o.memo(function({suggestion:a,onVote:d,reviewSuggestion:t}){const{userInfo:r}=q(),n=o.useMemo(()=>a.votes.includes((r==null?void 0:r._id)||""),[a.votes,r==null?void 0:r._id]),u=o.useMemo(()=>(r==null?void 0:r.role)==="ADMIN",[r==null?void 0:r.role]),s=o.useCallback(()=>{d()},[d]),p=o.useCallback(()=>{t==null||t(a._id,"APPROVED")},[t,a._id]),b=o.useCallback(()=>{t==null||t(a._id,"REJECTED")},[t,a._id]);return e.jsx(w,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.05)",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 24px rgba(0,0,0,0.1)"}},children:e.jsxs(E,{sx:{flexGrow:1,p:3},children:[e.jsx(x,{variant:"h6",sx:{fontWeight:600,mb:2},children:a.name}),e.jsx(x,{variant:"body2",color:"text.secondary",sx:{mb:3},children:a.description}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(S,{src:a.suggestedBy.avatar,alt:a.suggestedBy.name,sx:{width:24,height:24,mr:1},children:a.suggestedBy.name}),e.jsxs(x,{variant:"body2",color:"text.secondary",children:["Suggested by ",a.suggestedBy.name]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(g,{onClick:s,color:n?"primary":"default",sx:{p:1,backgroundColor:n?f=>`${f.palette.primary.main}08`:"transparent"},children:e.jsx(P,{fontSize:"small"})}),e.jsxs(x,{variant:"body2",color:"text.secondary",children:[a.votes.length," votes"]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[u&&a.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:p,color:"success",sx:{p:1},children:e.jsx(D,{fontSize:"small"})}),e.jsx(g,{onClick:b,color:"error",sx:{p:1},children:e.jsx(T,{fontSize:"small"})})]}),e.jsx(k,{label:a.status,color:a.status==="APPROVED"?"success":a.status==="REJECTED"?"error":"default",sx:{borderRadius:2,fontWeight:500,px:1}})]})]})]})})});function U({open:i,onClose:a,onSubmit:d}){const{enqueueSnackbar:t}=G(),[r,n]=o.useState({name:"",description:"",suggestedPointsCost:0,category:"LOCAL_PERK"}),u=async s=>{s.preventDefault(),await d(r)?(t("Reward suggestion submitted successfully!",{variant:"success"}),n({name:"",description:"",suggestedPointsCost:0,category:"LOCAL_PERK"}),a()):t("Failed to submit reward suggestion",{variant:"error"})};return e.jsxs(W,{open:i,onClose:a,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2,boxShadow:"0 8px 32px rgba(0,0,0,0.1)"}},children:[e.jsx(A,{sx:{pb:1,borderBottom:"1px solid",borderColor:"divider","& .MuiTypography-root":{fontSize:"1.5rem",fontWeight:600,color:"primary.main"}},children:"Suggest a Reward"}),e.jsx(_,{sx:{pt:3},children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(j,{label:"Name",value:r.name,onChange:s=>n({...r,name:s.target.value}),required:!0,fullWidth:!0,InputProps:{sx:{borderRadius:2,"& fieldset":{borderColor:"divider"},"&:hover fieldset":{borderColor:"primary.main"}}}}),e.jsx(j,{label:"Description",value:r.description,onChange:s=>n({...r,description:s.target.value}),required:!0,multiline:!0,rows:4,fullWidth:!0,InputProps:{sx:{borderRadius:2,"& fieldset":{borderColor:"divider"},"&:hover fieldset":{borderColor:"primary.main"}}}}),e.jsxs(I,{fullWidth:!0,required:!0,children:[e.jsx(M,{children:"Category"}),e.jsxs(L,{value:r.category,label:"Category",onChange:s=>n({...r,category:s.target.value}),sx:{borderRadius:2,"& fieldset":{borderColor:"divider"},"&:hover fieldset":{borderColor:"primary.main"}},children:[e.jsx(h,{value:"LOCAL_PERK",children:"Local Perk"}),e.jsx(h,{value:"GIFT_CARD",children:"Gift Card"}),e.jsx(h,{value:"EXPERIENCE",children:"Experience"}),e.jsx(h,{value:"MERCHANDISE",children:"Merchandise"})]})]}),e.jsx(j,{type:"number",label:"Suggested Points Cost",value:r.suggestedPointsCost,onChange:s=>n({...r,suggestedPointsCost:Number(s.target.value)}),required:!0,fullWidth:!0,InputProps:{sx:{borderRadius:2,"& fieldset":{borderColor:"divider"},"&:hover fieldset":{borderColor:"primary.main"}}}})]})}),e.jsxs(B,{sx:{px:3,py:2,borderTop:"1px solid",borderColor:"divider"},children:[e.jsx(C,{onClick:a,variant:"outlined",sx:{borderRadius:2},children:"Cancel"}),e.jsx(C,{onClick:u,variant:"contained",sx:{borderRadius:2},children:"Submit Suggestion"})]})]})}function se(){const[i,a]=o.useState(0),[d,t]=o.useState(!1),{rewards:r,loading:n,error:u}=J(),{suggestions:s,loading:p,createSuggestion:b,toggleVote:f,reviewSuggestion:R}=z();return e.jsxs(F,{maxWidth:"lg",sx:{py:4},children:[e.jsx(l,{sx:{mb:4,background:"linear-gradient(90deg, #1976d2 0%, #1565c0 100%)",p:3,borderRadius:2,color:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:e.jsx(x,{variant:"h4",component:"h1",sx:{fontWeight:600,mb:1},children:"Rewards Center"})}),e.jsx(l,{sx:{borderBottom:1,borderColor:"divider",mb:4,"& .MuiTabs-root":{minHeight:48},"& .MuiTab-root":{textTransform:"none",fontWeight:600,minHeight:48,fontSize:"1rem"}},children:e.jsxs(V,{value:i,onChange:(c,v)=>a(v),children:[e.jsx(y,{label:"Available Rewards"}),e.jsx(y,{label:"Suggestions"})]})}),i===0&&e.jsx(m,{container:!0,spacing:3,children:r.map(c=>e.jsx(m,{item:!0,xs:12,sm:6,md:4,children:e.jsx(N,{reward:c})},c._id))}),i===1&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(x,{variant:"h5",sx:{fontWeight:600,color:"primary.main"},children:"Reward Suggestions"}),e.jsx(C,{variant:"contained",onClick:()=>t(!0),sx:{borderRadius:2,textTransform:"none",px:3,py:1,fontWeight:600,boxShadow:"none","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.15)"}},children:"Suggest Reward"})]}),e.jsx(m,{container:!0,spacing:3,children:s.map(c=>e.jsx(m,{item:!0,xs:12,sm:6,md:4,children:e.jsx(K,{suggestion:c,onVote:()=>f(c._id),reviewSuggestion:R})},c._id))})]}),e.jsx(U,{open:d,onClose:()=>t(!1),onSubmit:b})]})}export{se as default};
